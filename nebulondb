#!/bin/bash

# ==============================
# NebulonDB CLI
# ==============================

COMMAND=$1

# Path to run script
RUN_SCRIPT="./ndb-run.sh"

# Make the run script executable if it exists
if [ -f "$RUN_SCRIPT" ]; then
    chmod +x "$RUN_SCRIPT"
else
    echo "‚ùå $RUN_SCRIPT not found. Please check your path."
    exit 1
fi

case "$COMMAND" in
    start)
        "$RUN_SCRIPT"
        ;;
    stop)
        pkill -f "gunicorn.*main:app"
        echo "üõë Stopped NebulonDB FastAPI server."
        ;;
    restart)
        pkill -f "gunicorn.*main:app"
        sleep 2
        "$RUN_SCRIPT"
        ;;
    *)
        echo "Usage: $0 {start|stop|restart}"
        exit 1
        ;;
esac